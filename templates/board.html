{% extends "base.html" %}
{% block content %}
<style>
    .feed-container {
        max-width: 700px;
        margin: 0 auto;
    }
    .feed-card {
        border: 1px solid #ddd;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        background-color: #fff;
        box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        transition: box-shadow 0.2s ease-in-out;
    }
    .feed-card:hover {
        box-shadow: 0 6px 12px rgba(0,0,0,0.08);
    }
    .feed-title {
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 10px;
    }
    .feed-meta {
        font-size: 13px;
        color: #888;
    }
    .write-button {
        display: flex;
        justify-content: end;
        margin-bottom: 20px;
    }
</style>

<div class="container mt-4 feed-container">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="fw-bold">ğŸ“‹ ê²Œì‹œíŒ í”¼ë“œ</h2>
        {% if current_user.is_authenticated %}
            <a href="{{ url_for('write') }}" class="btn btn-primary btn-sm">âœï¸ ê¸€ì“°ê¸°</a>
        {% endif %}
    </div>

    {% for post in posts %}
    <div class="feed-card">
        <div class="feed-title">{{ post.title }}</div>
        <div class="feed-meta">
            ì‘ì„±ì: <strong>{{ post.author.username }}</strong> Â· {{ post.created_at.strftime('%Y-%m-%d') }}
        </div>
        <hr>
        <p style="white-space: pre-line;">{{ post.content[:100] }}{% if post.content|length > 100 %}...{% endif %}</p>

        <div class="text-end d-flex justify-content-between align-items-center mt-3">
            <!-- ì¢‹ì•„ìš” ë²„íŠ¼ -->
            <form method="POST" action="{{ url_for('like', post_id=post.id) }}" class="m-0">
                <button type="submit" class="btn btn-outline-danger btn-sm">â¤ï¸ {{ post.likes }}</button>
            </form>
        
            <div>
                <!-- ë”ë³´ê¸° ë²„íŠ¼ -->
                <a href="{{ url_for('post_detail', post_id=post.id) }}" class="btn btn-sm btn-outline-secondary me-1">ë”ë³´ê¸°</a>
        
                <!-- ì‚­ì œ ë²„íŠ¼ (ì‘ì„±ìë§Œ) -->
                {% if current_user.is_authenticated and current_user.id == post.author_id %}
                    <form method="POST" action="{{ url_for('delete_post', post_id=post.id) }}" class="d-inline" onsubmit="return confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”?');">
                        <button type="submit" class="btn btn-sm btn-outline-danger">ğŸ—‘ ì‚­ì œ</button>
                    </form>
                {% endif %}
            </div>
        </div>
        
{% else %}
    <p class="text-muted">ì•„ì§ ì‘ì„±ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
{% endfor %}


{% endblock %}
